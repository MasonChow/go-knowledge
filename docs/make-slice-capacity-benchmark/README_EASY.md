# Go 切片容量：一行代码让性能飞起还是崩溃？

---

## 1. 默认 vs 预设容量，差别有多大？

- **默认容量**：像买小号收纳箱，东西多了就得不停换更大的箱子，每次都要把东西搬家。
- **预设容量**：一开始就买好大箱子，后面怎么装都不用搬家。

---

## 2. 代码对比：你会写哪种？

- 默认：`make([]T, 0)`
- 预设：`make([]T, 0, N)`（N 为最大长度）

---

## 3. 性能一眼明了：多次搬家有多坑？

| 元素数 | 写法     | 平均耗时(ms) | 内存占用(KB) | 分配次数 | 说明         |
| ------ | -------- | ------------ | ------------ | -------- | ------------ |
| 100    | 预设容量 | 0.00018      | 0.88         | 1        | 一次分配到位 |
| 100    | 默认容量 | 0.00023      | 1.00         | 7        | 多次扩容搬家 |
| 10000  | 预设容量 | 0.0126       | 80.0         | 1        | 一次分配到位 |
| 10000  | 默认容量 | 0.0165       | 125.3        | 16       | 多次扩容搬家 |

---

## 4. 原理小漫画：为什么预设容量更优？

- 默认容量：每次装满就得买更大箱子，把东西全搬过去。
- 预设容量：一开始就买好大箱子，省时省力。

---

## 5. 实战建议：怎么写才最省心？

- 能预估最大长度时，强烈建议预设容量。
- 超过预设容量还是会扩容，所以预设要尽量准确。

---

## 6. 总结：预设容量=一次到位，默认容量=多次搬家

- 预设容量=一次到位，省时省内存。
- 默认容量=多次搬家，耗时耗内存。
